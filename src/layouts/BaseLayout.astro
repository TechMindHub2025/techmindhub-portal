---
/**
 * BaseLayout.astro — TechMind Hub
 * - Banner (desktop + mobile via <picture>)
 * - Soft gradient overlay on banner (bottom → top)
 * - Favicon / PWA manifest links
 * - Canonical + OpenGraph + Twitter cards (default OG image: /og.png)
 */

type Props = {
  title?: string;
  description?: string;
  ogImage?: string; // absolute or /path
  ogType?: string;  // "website" | "article" etc
  noindex?: boolean;
};

const {
  title = "TechMind Hub",
  description = "TechMind Hub — curated signals across AI, robotics, automation, and enterprise tech.",
  ogImage = "/og.png",
  ogType = "website",
  noindex = false,
} = Astro.props;

const canonical = new URL(Astro.url.pathname, Astro.site ?? Astro.url.origin).toString();

const path = Astro.url.pathname;
const isActive = (href: string) => {
  if (href === "/") return path === "/";
  return path === href || path.startsWith(href + "/");
};
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="canonical" href={canonical} />

    {noindex ? <meta name="robots" content="noindex,nofollow" /> : null}

    <!-- Favicons -->
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />

    <!-- Optional: helps Windows tiles / pinned tabs -->
    <meta name="theme-color" content="#F9FAFB" />

    <!-- OpenGraph -->
    <meta property="og:site_name" content="TechMind Hub" />
    <meta property="og:type" content={ogType} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonical} />
    <meta property="og:image" content={ogImage} />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImage} />

    <style>
      :root {
        color-scheme: light;

        /* Brand */
        --tmh-primary: #0046AF;
        --tmh-accent: #00CFFD;
        --tmh-text: #003E54;

        /* UI */
        --tmh-bg: #F9FAFB;
        --tmh-card: #FFFFFF;
        --tmh-border: rgba(0,0,0,0.08);
        --tmh-muted: rgba(0, 0, 0, 0.6);
        --tmh-shadow: 0 10px 30px rgba(0,0,0,0.06);
        --tmh-radius: 18px;
      }

      html, body {
        margin: 0;
        padding: 0;
        background: var(--tmh-bg);
        color: var(--tmh-text);
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      }

      a { color: inherit; }

      .wrap {
        max-width: 1100px;
        margin: 0 auto;
        padding: 0 24px 24px;
      }

      /* ===== Banner ===== */
      .banner {
        position: relative;
        width: 100%;
        overflow: hidden;
        border-bottom: 1px solid var(--tmh-border);
        background: #fff;
      }

      .banner img {
        display: block;
        width: 100%;
        height: auto;
      }

      /* the soft fade you asked to keep (bottom → top, light tone) */
      .banner::after {
        content: "";
        position: absolute;
        left: 0; right: 0; bottom: 0;
        height: 140px;
        pointer-events: none;
        background: linear-gradient(
          to top,
          rgba(249, 250, 251, 1) 0%,
          rgba(249, 250, 251, 0.65) 45%,
          rgba(249, 250, 251, 0) 100%
        );
      }

      /* ===== Topbar (logo + nav) ===== */
      .topbar {
        border-bottom: 1px solid var(--tmh-border);
        background: rgba(255,255,255,0.8);
        backdrop-filter: blur(8px);
      }

      .topbar-inner {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        padding: 14px 0;
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 12px;
        min-width: 260px;
      }

      .brand img {
        width: 40px;
        height: 40px;
        border-radius: 999px;
        box-shadow: 0 6px 16px rgba(0,0,0,0.08);
      }

      .brand-title {
        display: flex;
        flex-direction: column;
        line-height: 1.15;
      }

      .brand-title strong {
        font-size: 14px;
        letter-spacing: 0.2px;
      }

      .brand-title span {
        font-size: 12px;
        color: rgba(0,0,0,0.55);
      }

      nav {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .navlink {
        text-decoration: none;
        font-weight: 700;
        font-size: 14px;
        padding: 8px 12px;
        border-radius: 12px;
        color: rgba(0,0,0,0.75);
      }

      .navlink:hover {
        background: rgba(0, 70, 175, 0.06);
        color: var(--tmh-primary);
      }

      .navlink.active {
        background: rgba(0, 70, 175, 0.08);
        color: var(--tmh-primary);
      }

      main {
        padding-top: 22px;
      }

      /* ===== Footer ===== */
      footer {
        margin-top: 54px;
        padding-top: 16px;
        border-top: 1px solid var(--tmh-border);
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        color: rgba(0,0,0,0.55);
        font-size: 13px;
      }

      .footer-right {
        display: inline-flex;
        align-items: center;
        gap: 10px;
      }

      .footer-right img {
        width: 22px;
        height: 22px;
        border-radius: 999px;
        opacity: 0.9;
      }

      /* Responsive */
      @media (max-width: 720px) {
        .wrap { padding: 0 16px 16px; }
        .topbar-inner { flex-direction: column; align-items: flex-start; }
        nav { width: 100%; justify-content: flex-end; }
        .brand { min-width: unset; }
        .banner::after { height: 110px; }
      }
    </style>
  </head>

  <body>
    <!-- Banner: desktop + mobile -->
    <div class="banner" role="presentation" aria-hidden="true">
      <picture>
        <source media="(max-width: 720px)" srcset="/banner-mobile.png" />
        <img src="/banner.png" alt="" />
      </picture>
    </div>

    <!-- Top bar -->
    <div class="topbar">
      <div class="wrap">
        <div class="topbar-inner">
          <a class="brand" href="/" style="text-decoration:none;">
            <img src="/logo.png" alt="TechMind Hub logo" />
            <div class="brand-title">
              <strong>TechMind Hub</strong>
              <span>AI • Robotics • Automation • Enterprise Tech</span>
            </div>
          </a>

          <nav aria-label="Primary">
            <a class={"navlink " + (isActive("/") ? "active" : "")} href="/" aria-current={isActive("/") ? "page" : undefined}>Home</a>
            <a class={"navlink " + (isActive("/posts") ? "active" : "")} href="/posts" aria-current={isActive("/posts") ? "page" : undefined}>Posts</a>
            <a class={"navlink " + (isActive("/about") ? "active" : "")} href="/about" aria-current={isActive("/about") ? "page" : undefined}>About</a>
          </nav>
        </div>
      </div>
    </div>

    <div class="wrap">
      <main>
        <slot />
      </main>

      <footer>
        <div>© {new Date().getFullYear()} TechMind Hub</div>
        <div class="footer-right">
          <img src="/logo.png" alt="" />
          <span>Built on Astro + GitHub Pages</span>
        </div>
      </footer>
    </div>
  </body>
</html>
