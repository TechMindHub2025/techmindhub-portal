---
/**
 * BaseLayout.astro — TechMind Hub
 * - Banner (desktop + mobile via <picture>)
 * - Soft gradient overlay on banner (bottom → top)
 * - Favicon / PWA manifest links
 * - Canonical + OpenGraph + Twitter cards (default OG image: /og.png)
 */

import "../styles/ui.css";

type Props = {
  title?: string;
  description?: string;
  ogImage?: string; // absolute or /path
  ogType?: string;  // "website" | "article" etc
  noindex?: boolean;
};

const {
  title = "TechMind Hub",
  description = "TechMind Hub — curated signals across AI, robotics, automation, and enterprise tech.",
  ogImage = "/og.png",
  ogType = "website",
  noindex = false,
} = Astro.props;

const canonical = new URL(Astro.url.pathname, Astro.site ?? Astro.url.origin).toString();

const path = Astro.url.pathname;
const isActive = (href: string) => {
  if (href === "/") return path === "/";
  return path === href || path.startsWith(href + "/");
};
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="canonical" href={canonical} />

    {noindex ? <meta name="robots" content="noindex,nofollow" /> : null}

    <!-- Favicons -->
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />

    <!-- Optional: helps Windows tiles / pinned tabs -->
    <meta name="theme-color" content="#F9FAFB" />

    <!-- OpenGraph -->
    <meta property="og:site_name" content="TechMind Hub" />
    <meta property="og:type" content={ogType} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonical} />
    <meta property="og:image" content={ogImage} />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImage} />

  </head>

  <body>
    <!-- Banner: desktop + mobile -->
    <div class="banner" role="presentation" aria-hidden="true">
      <picture>
        <source media="(max-width: 720px)" srcset="/banner-mobile.png" />
        <img src="/banner.png" alt="" />
      </picture>
    </div>

    <!-- Top bar -->
    <div class="topbar">
      <div class="wrap">
        <div class="topbar-inner">
          <a class="brand" href="/">
            <img src="/logo.png" alt="TechMind Hub logo" />
            <div class="brand-title">
             <strong>TechMind Hub</strong>
              <span>AI • Robotics • Automation • Enterprise Tech • Networks</span>
            </div>
          </a>

          <nav aria-label="Primary">
            <a class={"navlink " + (isActive("/") ? "active" : "")} href="/" aria-current={isActive("/") ? "page" : undefined}>Home</a>
            <a class={"navlink " + (isActive("/posts") ? "active" : "")} href="/posts" aria-current={isActive("/posts") ? "page" : undefined}>Posts</a>
            <a class={"navlink " + (isActive("/about") ? "active" : "")} href="/about" aria-current={isActive("/about") ? "page" : undefined}>About</a>
          </nav>
        </div>
      </div>
    </div>

    <div class="wrap">
      <main>
        <slot />
      </main>

      <footer>
        <div>© {new Date().getFullYear()} TechMind Hub</div>
        <div class="footer-right">
          <img src="/logo.png" alt="" />
          <span>Built on Astro + GitHub Pages</span>
        </div>
      </footer>
    </div>
  </body>
</html>
